import{a as E}from"./chunk-LIG3KEFC.js";import{a as d}from"./chunk-Y2ZDU5CO.js";import{a as q}from"./chunk-U4XC2GOP.js";import{a as z}from"./chunk-BCA4Q5XO.js";import{a as V,b as W}from"./chunk-UFRAF5IV.js";import"./chunk-XLIKHLUI.js";import"./chunk-JJAHF3FC.js";import{c as y,d as f}from"./chunk-QPXJIEBY.js";import{$ as M,$a as S,Ea as g,Ga as m,Ka as u,Kb as w,L as C,La as h,Ma as N,Mb as D,Nb as H,O as k,Ua as I,ab as T,cb as A,gb as O,hb as $,ib as b,l as F,ob as x,rb as j,tb as G,ub as B,va as l,vb as P,wa as c,z as R}from"./chunk-KN6KQJWB.js";var K=()=>({"grid-template-columns":"none"}),Q=()=>({});function U(i,r){i&1&&N(0,"div")}function X(i,r){if(i&1&&N(0,"item-card",7),i&2){let a=r.$implicit;m("name",a.name)("link",a.routerLink)("imageResource",a.imgSrc)("spoiler",a.spoiler)}}function Y(i,r){if(i&1&&(u(0,"div",5),g(1,X,1,4,"item-card",6),h()),i&2){let a=I();l(),m("ngForOf",a._items)}}function Z(i,r){if(i&1&&(u(0,"a",10)(1,"button",11),T(2),h()()),i&2){let a=r.$implicit;m("routerLink",a.routerLink),l(2),A(" ",a.name,"")}}function ee(i,r){if(i&1&&(u(0,"div",8),g(1,Z,3,2,"a",9),h()),i&2){let a=I();m("ngClass",a._items.length>20?"search-items-grid":"items-list_container")("ngStyle",a._items.length==1?b(3,K):b(4,Q)),l(),m("ngForOf",a._items)}}var fe=(()=>{let r=class r{constructor(n,e,t,p){this.route=n,this.router=e,this.gameRootService=t,this.restApiService=p,this._items=[],this.gameName="",this._routes=!1,this.headerText="",this.hasImages=!1,this.easterEggs=!0}ngOnInit(){let n=[this.route.paramMap];f.mapping||n.push(this.restApiService.get("nameMapping").pipe(k(e=>{f.mapping=e}))),this.route.parent?.paramMap.pipe(R(n),C(e=>{this.easterEggs=localStorage.getItem(y.easterEggs)?localStorage.getItem(y.easterEggs)=="true":!0,this.gameName=e[0].get("gameName");let t=this.router.url.split("/").at(-1);if(this._routes=t==="routes",this._routes)return this.restApiService.get("gameRouteConfig",{pathParams:{gameName:this.gameName}});{let p=e[1].has("routeName")?"routedGameChapterConfig":"nonRoutedGameChapterConfig";return this.restApiService.get(p,{pathParams:{gameName:this.gameName,routeName:e[1].get("routeName")}}).pipe(C(o=>{let _=[],te=o.chapters,L=o.chapterOrder;if(L)L.forEach((s,v)=>{let J=E.resolveChapterName(o,v);_.push({name:J,routerLink:`${s}`})});else for(let s=1;s<=o.total;s++){let v=E.resolveChapterName(o,s);_.push({name:v,routerLink:`${s}`})}return F({headerLabel:o.headerLabel||e[1].get("routeName")&&`${e[1].get("routeName")} route chapters`||`${f.mapping[this.gameName]&&f.mapping[this.gameName]+" "||""}chapters`,items:_})}))}})).subscribe(e=>{this.easterEggs&&e?.items.some(t=>t.alternativeImgs)?this._items=e?.items.map(t=>(t.alternativeImgs&&Math.random()>.75&&(t.alternativeImgs.length>1?t.imgSrc=this.selectRandom(t.alternativeImgs):t.imgSrc=t.alternativeImgs[0]),t)):this._items=e?.items,this.hasImages=!!this._items?.some(t=>!!t.imgSrc),e.headerLabel&&this.gameRootService.pushHeader(e.headerLabel)})}selectRandom(n){let e=Math.floor(Math.random()*n.length);return n[e]}};r.\u0275fac=function(e){return new(e||r)(c(w),c(D),c(q),c(d))},r.\u0275cmp=M({type:r,selectors:[["chapter-navigation"]],standalone:!0,features:[O([d]),$],decls:7,vars:3,consts:[["routes",""],["buttons",""],[1,"items-list_body"],[1,"items-list_scroll"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"items-list_container"],[3,"name","link","imageResource","spoiler",4,"ngFor","ngForOf"],[3,"name","link","imageResource","spoiler"],[3,"ngClass","ngStyle"],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["appearance","custom","tuiButton","","type","button",1,"items-list_item-button"]],template:function(e,t){if(e&1&&(u(0,"div",2)(1,"div",3),g(2,U,1,0,"div",4),h()(),g(3,Y,2,1,"ng-template",null,0,x)(5,ee,2,5,"ng-template",null,1,x)),e&2){let p=S(4),o=S(6);l(2),m("ngIf",t._routes&&t.hasImages)("ngIfThen",p)("ngIfElse",o)}},dependencies:[z,B,G,j,P,H,W,V],encapsulation:2});let i=r;return i})();export{fe as ChapterNavigationComponent};
