import{a as Wt,b as _e,c as Ce,d as Qt,e as Ie,f as be,g as qt,h as De,i as Yt,j as Oe,k as Zt}from"./chunk-EGG4MD3H.js";import"./chunk-UIC6OLMX.js";import"./chunk-VHQZ63EU.js";import{a as Ze}from"./chunk-LIG3KEFC.js";import"./chunk-3SD6P5XB.js";import{a as V}from"./chunk-KGA3LBVL.js";import{a as Xt}from"./chunk-U4XC2GOP.js";import"./chunk-3T7R53LO.js";import{a as k}from"./chunk-SW5ADHBM.js";import{a as Te,b as ye}from"./chunk-UFRAF5IV.js";import"./chunk-XLIKHLUI.js";import{d as kt,e as Bt}from"./chunk-JJAHF3FC.js";import{$ as I,$a as F,$b as ve,Ab as H,Da as x,Dd as qe,Ea as h,Ed as Ye,Fa as je,Ga as a,Gd as At,H as lt,Ha as Ct,Hd as jt,Ia as U,Id as zt,Jc as St,Ka as c,Kb as Ot,L as b,La as d,Lc as B,Ma as D,Mc as Ft,Na as ze,Nb as ue,O as K,Oa as He,Od as Ht,P as ct,Pa as W,Pb as Mt,Qa as ee,R as dt,Rb as xt,S as v,Sb as le,T as G,Ta as _,Tb as ce,U as Le,Ua as T,Ub as de,V as pt,Va as ke,Vb as pe,W as mt,Wa as te,Wd as Vt,X as ft,Xa as Q,Xb as me,Xc as Et,Ya as Be,Za as w,Zb as fe,_a as S,_b as he,a as et,aa as g,ab as O,ac as ge,ad as Nt,b as tt,ba as f,bb as It,cb as q,db as ie,e as it,eb as ne,f as X,fa as P,fb as oe,ga as R,gb as C,h as nt,hb as A,ia as ht,ic as Ue,ja as Ae,jb as Ve,jc as We,k as ot,l as Re,la as L,lb as $e,lc as wt,ma as vt,mb as Ge,n as E,o as rt,ob as re,pb as j,pc as Qe,qd as Pt,qe as $t,r as N,rb as Tt,ta as gt,tb as z,td as Rt,u as st,ua as _t,ub as se,v as at,va as l,vb as yt,wa as s,wb as bt,wd as Lt,x as ut,xb as Dt,xe as Gt,ya as J,yb as ae,ze as Ut}from"./chunk-KN6KQJWB.js";var Me=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=f({type:e,selectors:[["","tuiItem",""]]}),e})(),Kt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g({type:e}),e.\u0275inj=v({}),e})();var Jt=(()=>{class e{constructor(t){this.tuiPan=t}}return e.\u0275fac=function(t){return new(t||e)(s(qe))},e.\u0275dir=f({type:e,selectors:[["","tuiPan",""]],outputs:{tuiPan:"tuiPan"},features:[C([qe])]}),e})(),ei=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g({type:e}),e.\u0275inj=v({}),e})();var ti=(()=>{class e{constructor(t){this.tuiSwipe=t}}return e.\u0275fac=function(t){return new(t||e)(s(Ye))},e.\u0275dir=f({type:e,selectors:[["","tuiSwipe",""]],outputs:{tuiSwipe:"tuiSwipe"},features:[C([Ye])]}),e})(),ii=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g({type:e}),e.\u0275inj=v({}),e})();var ni=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=f({type:e,selectors:[["ng-template","tuiDataList",""]]}),e})();var Ii=new G("Root element for IntersectionObserver"),ri="0px 0px 0px 0px",sn=new G("rootMargin for IntersectionObserver",{providedIn:"root",factory:()=>ri});function Ti(e){return e||ri}var si=0,an=new G("threshold for IntersectionObserver",{providedIn:"root",factory:()=>si});function yi(e){return e?.split(",").map(parseFloat)||si}var bi=typeof IntersectionObserver<"u"?IntersectionObserver:class{constructor(){this.root=null,this.rootMargin="",this.thresholds=[]}observe(){}unobserve(){}disconnect(){}takeRecords(){return[]}},Xe=(()=>{class e extends bi{constructor(t,i,n){super(r=>{this.callbacks.forEach((p,u)=>{let m=r.filter(({target:Fe})=>Fe===u);return m.length&&p(m,this)})},{root:t&&t.nativeElement,rootMargin:Ti(i),threshold:yi(n)}),this.callbacks=new Map}observe(t,i=()=>{}){super.observe(t),this.callbacks.set(t,i)}unobserve(t){super.unobserve(t),this.callbacks.delete(t)}ngOnDestroy(){this.disconnect()}}return e.\u0275fac=function(t){return new(t||e)(s(Ii,8),Ae("waIntersectionRootMargin"),Ae("waIntersectionThreshold"))},e.\u0275dir=f({type:e,selectors:[["","waIntersectionObserver",""]],exportAs:["IntersectionObserver"],features:[x]}),e})(),oi=(()=>{class e extends X{constructor({nativeElement:t},i){return super(n=>(i.observe(t,r=>{n.next(r)}),()=>{i.unobserve(t)})),this.pipe(lt())}}return e.\u0275fac=function(t){return new(t||e)(Le(L),Le(Xe))},e.\u0275prov=dt({token:e,factory:e.\u0275fac}),e})(),ai=(()=>{class e{constructor(t){this.waIntersectionObservee=t}}return e.\u0275fac=function(t){return new(t||e)(s(oi))},e.\u0275dir=f({type:e,selectors:[["","waIntersectionObservee",""]],outputs:{waIntersectionObservee:"waIntersectionObservee"},features:[C([oi])]}),e})();var ui=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g({type:e}),e.\u0275inj=v({}),e})(),un=new G("Intersection Observer API support",{providedIn:"root",factory:()=>!!pt(Et).IntersectionObserver});var li=Wt({limitWidth:"fixed",align:"right"}),ci={provide:Ut,deps:[[new mt,new ft,Mt]],useFactory:it};function Oi(e,o){e&1&&W(0)}function Mi(e,o){if(e&1){let t=ee();c(0,"fieldset",5),_("waIntersectionObservee",function(n){let r=P(t).index,p=T();return R(p.onIntersection(n[0],r))}),W(1,6),d()}if(e&2){let t=o.$implicit,i=o.index,n=T();a("disabled",n.isDisabled(i))("ngStyle",n.getStyle(n.itemsCount)),l(),a("ngTemplateOutlet",t)}}var xi=(()=>{class e{constructor(t){this.el=t,this.tuiCarouselScroll=B(this.el.nativeElement,"wheel").pipe(ut(({deltaX:i})=>Math.abs(i)>20),ct(500),E(({deltaX:i})=>Math.sign(i)),K(()=>{this.el.nativeElement.scrollLeft=10}))}}return e.\u0275fac=function(t){return new(t||e)(s(L))},e.\u0275dir=f({type:e,selectors:[["","tuiCarouselScroll",""]],outputs:{tuiCarouselScroll:"tuiCarouselScroll"}}),e})(),Ke=(()=>{class e extends X{constructor(t,i){super(n=>this.output$.subscribe(n)),this.el=t,this.visible$=i,this.duration$=new nt(0),this.running$=at(B(this.el.nativeElement,"mouseenter").pipe(E(Ue)),B(this.el.nativeElement,"touchstart").pipe(E(Ue)),B(this.el.nativeElement,"touchend").pipe(E(We)),B(this.el.nativeElement,"mouseleave").pipe(E(We)),this.visible$),this.output$=rt([this.duration$,this.running$]).pipe(Ft(([n])=>st(n),n=>n.every(Boolean)))}set duration(t){this.duration$.next(t)}set index(t){this.duration$.next(this.duration$.value)}}return e.\u0275fac=function(t){return new(t||e)(s(L),s(Nt))},e.\u0275dir=f({type:e,selectors:[["tui-carousel"]],inputs:{duration:"duration",index:"index"},features:[x]}),e})(),wi=(()=>{class e{constructor(t){this.tuiCarouselAutoscroll=t}}return e.\u0275fac=function(t){return new(t||e)(s(Ke))},e.\u0275dir=f({type:e,selectors:[["","tuiCarouselAutoscroll",""]],outputs:{tuiCarouselAutoscroll:"tuiCarouselAutoscroll"}}),e})(),pi=(()=>{class e{constructor(t,i,n){this.cdr=t,this.el=i,this.isMobile=n,this.translate=0,this.draggable=!1,this.itemsCount=1,this.index=0,this.indexChange=new vt,this.items=wt,this.transitioned=!0}get transform(){return`translateX(${100*(this.transitioned?this.computedTranslate:this.translate)}%)`}onTransitioned(t){this.transitioned=t,t||(this.translate=this.computedTranslate)}getStyle(t){let i=`${100/t}%`;return{flexBasis:i,minWidth:i,maxWidth:i}}next(){this.items&&this.index===this.items.length-this.itemsCount||this.updateIndex(this.index+1)}prev(){this.updateIndex(this.index-1)}isDisabled(t){return t<this.index||t>this.index+this.itemsCount}onIntersection({intersectionRatio:t},i){t&&t>=.5&&!this.transitioned&&this.updateIndex(this.index<i?i-this.itemsCount+1:i)}onScroll(t){this.isMobile||(t>0?this.next():this.prev())}onPan(t){if(!this.computedDraggable)return;let{clientWidth:i}=this.el.nativeElement,n=1-this.items.length/this.itemsCount;this.translate=Qe(t/i+this.translate,n,0)}onSwipe(t){t==="left"?this.next():t==="right"&&this.prev()}onAutoscroll(){this.updateIndex(this.index===this.items.length-1?0:this.index+1)}get computedTranslate(){return-this.index/this.itemsCount}get computedDraggable(){return this.isMobile||this.draggable}updateIndex(t){this.index=Qe(t,0,this.items.length-1),this.indexChange.emit(this.index),this.cdr.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(s(j),s(L),s(Rt))},e.\u0275cmp=I({type:e,selectors:[["tui-carousel"]],contentQueries:function(t,i,n){if(t&1&&Q(n,Me,4,J),t&2){let r;w(r=S())&&(i.items=r)}},hostVars:4,hostBindings:function(t,i){t&1&&_("touchstart",function(){return i.onTransitioned(!1)})("touchend",function(){return i.onTransitioned(!0)})("mousedown",function(){return i.onTransitioned(!1)})("mouseup.silent",function(){return i.onTransitioned(!0)},!1,_t),t&2&&U("_draggable",i.draggable)("_transitioned",i.transitioned)},inputs:{draggable:"draggable",itemsCount:"itemsCount",index:"index"},outputs:{indexChange:"indexChange"},features:[C([{provide:Lt,useValue:{timeout:200,threshold:30}}])],decls:6,vars:6,consts:[[4,"ngIf"],[1,"t-scroller",3,"tuiCarouselScroll"],["waIntersectionObserver","","waIntersectionThreshold","0.5",1,"t-wrapper"],[1,"t-items",3,"tuiCarouselAutoscroll","tuiPan","tuiSwipe"],["class","t-item",3,"disabled","ngStyle","waIntersectionObservee",4,"ngFor","ngForOf"],[1,"t-item",3,"waIntersectionObservee","disabled","ngStyle"],[3,"ngTemplateOutlet"]],template:function(t,i){t&1&&(h(0,Oi,1,0,"ng-container",0),$e(1,"async"),c(2,"div",1),_("tuiCarouselScroll",function(r){return i.onScroll(r)}),c(3,"div",2)(4,"div",3),_("tuiCarouselAutoscroll",function(){return i.onAutoscroll()})("tuiPan",function(r){return i.onPan(r[0])})("tuiSwipe",function(r){return i.onSwipe(r.direction)}),h(5,Mi,2,3,"fieldset",4),d()()()),t&2&&(a("ngIf",Ge(1,4,i.items.changes)),l(4),Ct("transform",i.transform),l(),a("ngForOf",i.items))},dependencies:[se,xi,Xe,wi,Jt,ti,z,yt,ai,bt,Dt],styles:['[_nghost-%COMP%]{position:relative;display:block;overflow:hidden}._draggable[_nghost-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none}._draggable[_nghost-%COMP%]:hover{cursor:grab}._draggable[_nghost-%COMP%]:active{cursor:grabbing}.t-items[_ngcontent-%COMP%]{display:flex}._transitioned[_nghost-%COMP%]   .t-items[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:var(--tui-carousel-padding, 0 1.25rem);flex:1;min-width:100%;max-width:100%;box-sizing:border-box;border:none;margin:0}.t-wrapper[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;left:0;right:0;min-width:100%;overflow:hidden}.t-scroller[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;overflow:auto;overscroll-behavior-x:none;touch-action:none}.t-scroller[_ngcontent-%COMP%]::-webkit-scrollbar, .t-scroller[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{display:none}.t-scroller[_ngcontent-%COMP%]:before, .t-scroller[_ngcontent-%COMP%]:after{content:"";display:block;min-width:1rem}'],changeDetection:0}),ot([Ht],e.prototype,"getStyle",null),e})();var mi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g({type:e}),e.\u0275inj=v({imports:[[ae,ui,ei,ii,Kt]]}),e})();var Si=["*",[["input"]]],Fi=["*","input"],xe=(()=>{class e extends jt{constructor(t,i,n,r){super(t,i,r),this.textfieldSize=n,this.open=!1}get size(){return this.textfieldSize.size}get nativeFocusableElement(){return this.computedDisabled||!this.textfield?null:this.textfield.nativeFocusableElement}get focused(){return St(this.nativeFocusableElement)||!!this.hostedDropdown&&this.hostedDropdown.focused}get canOpen(){return this.interactive&&!!this.datalist}onValueChange(t){this.value=t,this.open=!0}onActiveZone(t){this.updateFocused(t)}handleOption(t){this.setNativeValue(String(t)),this.focusInput(),this.value=String(t),this.open=!1}getFallbackValue(){return""}focusInput(t=!1){this.nativeFocusableElement&&this.nativeFocusableElement.focus({preventScroll:t})}setNativeValue(t){this.nativeFocusableElement&&(this.nativeFocusableElement.value=t)}}return e.\u0275fac=function(t){return new(t||e)(s(xt,10),s(j),s(Qt),s(At,8))},e.\u0275cmp=I({type:e,selectors:[["tui-input"]],contentQueries:function(t,i,n){if(t&1&&Q(n,ni,5,J),t&2){let r;w(r=S())&&(i.datalist=r.first)}},viewQuery:function(t,i){if(t&1&&(Be(be,5),Be(De,5)),t&2){let n;w(n=S())&&(i.hostedDropdown=n.first),w(n=S())&&(i.textfield=n.first)}},hostVars:1,hostBindings:function(t,i){t&2&&je("data-size",i.size)},features:[C([ci,Pt(e),$t(e),zt(e)],[li]),x],ngContentSelectors:Fi,decls:4,vars:11,consts:[[1,"t-hosted",3,"openChange","tuiActiveZoneChange","canOpen","content","open"],["automation-id","tui-input__textfield",1,"t-textfield",3,"valueChange","disabled","focusable","invalid","nativeId","pseudoFocus","pseudoHover","readOnly","value"]],template:function(t,i){t&1&&(ke(Si),c(0,"tui-hosted-dropdown",0),oe("openChange",function(r){return ne(i.open,r)||(i.open=r),r}),_("tuiActiveZoneChange",function(r){return i.onActiveZone(r)}),c(1,"tui-primitive-textfield",1),_("valueChange",function(r){return i.onValueChange(r)}),te(2),te(3,1,["ngProjectAs","input",5,["input"]]),d()()),t&2&&(a("canOpen",i.canOpen)("content",i.datalist||""),ie("open",i.open),l(),a("disabled",i.computedDisabled)("focusable",i.computedFocusable)("invalid",i.computedInvalid)("nativeId",i.nativeId)("pseudoFocus",i.computedFocused)("pseudoHover",i.pseudoHover)("readOnly",i.readOnly)("value",i.value))},dependencies:[be,De,kt,Yt],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}._disabled[_nghost-%COMP%]{pointer-events:none}.t-hosted[_ngcontent-%COMP%]{display:block;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}"],changeDetection:0}),e})(),we=(()=>{class e extends Vt{onValueChange(t){this.host.onValueChange(t)}}return e.\u0275fac=(()=>{let o;return function(i){return(o||(o=ht(e)))(i||e)}})(),e.\u0275dir=f({type:e,selectors:[["tui-input"]],features:[C([Gt(e)]),x]}),e})(),Se=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g({type:e}),e.\u0275inj=v({imports:[[ae,Bt,Zt,qt]]}),e})();function Pi(e,o){if(e&1&&(c(0,"div")(1,"a",6)(2,"button",7),O(3),d()()()),e&2){let t=o.$implicit;l(),a("routerLink",t.routerLink),l(2),q(" ",t.name,"")}}var gi=(()=>{let o=class o{constructor(i,n){this.globalLoaderService=i,this.restApi=n,this.filteredItems=[],this.searchForm=new de({search:new pe("")}),this.timeout=null,this.initialItems=[],this.prevSearchString=""}ngOnInit(){this.initControls(),this.restApi.get("nonRoutedGameChapterConfig",{pathParams:{gameName:this.gameName},requestOptions:{headers:new H({"Content-Encoding":"gzip"})}}).pipe(b(i=>{let n=i.total,r=Object.values(i.chapters).some(u=>!!u.name),p=[];this.initialItems=new Array(n);for(let u=0;u<n;u++){if(this.initialItems[u]={},r){let m=i.chapters[`${u+1}`];this.initialItems[u].name=m?.name||`Chapter ${u+1}`}else this.initialItems[u].name=`Chapter ${u+1}`;this.initialItems[u].routerLink=`../chapters/${u+1}`,p.push(this.restApi.get("nonRoutedChapterFile",{pathParams:{gameName:this.gameName,file:`${u+1}.txt.gz`},requestOptions:{headers:new H({Accept:"application/json;charset=utf-8","Content-Encoding":"gzip"}),responseType:"text"}}))}return N(p)})).subscribe(i=>{i.forEach((n,r)=>{this.initialItems[r].text=n}),this.filteredItems=this.initialItems,this.globalLoaderService.setGlobalLoader(!1)})}initControls(){this.searchForm.controls.search.valueChanges.subscribe(i=>{i?.length>0?(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.filterChapters(i)},500)):this.filteredItems.length!=this.initialItems.length&&(this.filteredItems=this.initialItems)})}filterChapters(i){let n=[];i.includes(this.prevSearchString)?n=this.filteredItems:n=this.initialItems,this.filteredItems=n?.filter(r=>r.text.includes(i)),this.prevSearchString=i}};o.\u0275fac=function(n){return new(n||o)(s(k),s(V))},o.\u0275cmp=I({type:o,selectors:[["chapters-items"]],inputs:{gameName:"gameName"},standalone:!0,features:[A],decls:7,vars:5,consts:[[1,"search-items"],[1,"items-list_filter-field",3,"formGroup"],[3,"formControlName","tuiTextfieldIcon","tuiTextfieldCleaner"],["tuiTextfield",""],[1,"search-items-grid"],[4,"ngFor","ngForOf"],[3,"routerLink"],["appearance","custom","tuiButton","","type","button",1,"items-list_item-button"]],template:function(n,r){n&1&&(c(0,"div",0)(1,"form",1)(2,"tui-input",2),O(3," Search for text in scenarios "),D(4,"input",3),d()(),c(5,"div",4),h(6,Pi,4,2,"div",5),d()()),n&2&&(l(),a("formGroup",r.searchForm),l(),a("formControlName","search")("tuiTextfieldIcon","tuiIconSearchLarge")("tuiTextfieldCleaner",!0),l(4),a("ngForOf",r.filteredItems))},dependencies:[ve,me,le,ce,ge,fe,he,z,Se,xe,we,Oe,Ie,_e,Ce,ye,Te,ue],encapsulation:2});let e=o;return e})();var Ri=e=>({spoiler:e});function Li(e,o){if(e&1&&(c(0,"div",14)(1,"a",15)(2,"button",16),O(3),d()()()),e&2){let t=o.$implicit;l(),a("routerLink",t.routerLink),l(2),q(" ",t.name," ")}}function Ai(e,o){if(e&1&&(c(0,"div",11)(1,"h2",12),O(2),d(),h(3,Li,4,2,"div",13),d()),e&2){let t=T(),i=t.$implicit,n=t.index,r=T();U("item_active",n===r.index+1),l(),a("ngClass",Ve(5,Ri,i.spoiler)),l(),It(i.name),l(),a("ngForOf",i.items)}}function ji(e,o){e&1&&(ze(0),h(1,Ai,4,7,"div",10),He())}var _i=(()=>{let o=class o{get index(){return this._index}set index(i){this._index=i}constructor(i,n,r){this.globalLoaderService=i,this.restApi=n,this.cdr=r,this._index=0,this.carouselCount=Math.ceil(window.innerWidth/500),this.searchForm=new de({search:new pe("")}),this.timeout=null,this.prevSearchString=""}ngOnInit(){this.initControls(),this.restApi.get("gameRouteConfig",{pathParams:{gameName:this.gameName}}).pipe(b(i=>{this.initialItems=i.items.map(r=>({name:r.name,spoiler:r.spoiler,items:[]}));let n=i.items.map(r=>this.restApi.get("routedGameChapterConfig",{pathParams:{gameName:this.gameName,routeName:r.routerLink},requestOptions:{headers:new H({"Content-Encoding":"gzip"})}}));return N(n).pipe(b(r=>{let p=this.getMappedRouteConfig(r,i);return N(p)}))})).subscribe(i=>{Object.entries(i).forEach((r,p)=>{this.initialItems[p].items=r[1]}),this.filteredItems=this.initialItems;let n=Math.ceil(window.innerWidth/500);this.carouselCount=Math.max(Math.min(n,this.filteredItems?.length),1),this.globalLoaderService.setGlobalLoader(!1)})}getMappedRouteConfig(i,n){return n.items.map((u,m)=>[u,i[m]]).reduce((u,m)=>{let Fe=m[0],M=m[1],Ee=Fe.routerLink,Ci=N(Array.from({length:M.total}).map((Je,Y)=>{let $="";return M.chapterOrder?$=M.chapterOrder[Y]:$=`${Y+1}`,this.restApi.get("routedChapterFile",{pathParams:{gameName:this.gameName,routeName:Ee,file:`${$}.txt.gz`},requestOptions:{headers:new H({Accept:"application/json;charset=utf-8","Content-Encoding":"gzip"}),responseType:"text"}})})).pipe(b(Je=>{let Y=Je.map(($,Z)=>{let Ne="",Pe="";return M.chapterOrder?(Ne=M.chapterOrder[Z],Pe=Ze.resolveChapterName(M,Z)):(Ne=`${Z+1}`,Pe=Ze.resolveChapterName(M,Z+1)),{name:Pe,text:$,routerLink:`../routes/${Ee}/${Ne}`}});return Re(Y)}));return tt(et({},u),{[Ee]:Ci})},{})}onResize(){let i=Math.ceil(window.innerWidth/500);this.carouselCount=Math.max(Math.min(i,this.filteredItems?.length),1)}initControls(){this.searchForm.controls.search.valueChanges.subscribe(i=>{i.length>0?(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.filterChapters(i),this.onResize(),this._index=0},500)):this.filteredItems&&this.initialItems&&this.filteredItems.length!=this.initialItems.length&&(this.filteredItems=this.initialItems,this.onResize())})}filterChapters(i){let n=[];i.includes(this.prevSearchString)?n=this.filteredItems:n=this.initialItems,this.filteredItems=n.map(r=>({items:r.items.filter(u=>u.text.includes(i)),name:r.name,spoiler:r.spoiler})).filter(r=>r.items.length>0),this.prevSearchString=i,this.globalLoaderService.setGlobalLoader(!1)}};o.\u0275fac=function(n){return new(n||o)(s(k),s(V),s(j))},o.\u0275cmp=I({type:o,selectors:[["routed-items"]],hostBindings:function(n,r){n&1&&_("resize",function(u){return r.onResize(u)},!1,gt)},inputs:{gameName:"gameName"},standalone:!0,features:[A],decls:11,vars:8,consts:[["carousel",""],[1,"search-items"],[1,"items-list_filter-field",3,"formGroup"],[3,"formControlName","tuiTextfieldIcon","tuiTextfieldCleaner"],["tuiTextfield",""],[1,"search-routes"],["icon","tuiIconChevronLeftLarge","title","Previous","tuiIconButton","","appearance","custom","type","button",1,"search_navigation-button","left",3,"click"],[3,"indexChange","draggable","itemsCount","index"],[4,"ngFor","ngForOf"],["icon","tuiIconChevronRightLarge","title","Next","tuiIconButton","","appearance","custom","type","button",1,"search_navigation-button","right",3,"click"],["class","search-route-item item","alt","","draggable","false",3,"item_active",4,"tuiItem"],["alt","","draggable","false",1,"search-route-item","item"],[3,"ngClass"],["class","search-route-chapters",4,"ngFor","ngForOf"],[1,"search-route-chapters"],[3,"routerLink"],["appearance","custom","tuiButton","","type","button",1,"items-list_item-button"]],template:function(n,r){if(n&1){let p=ee();c(0,"div",1)(1,"form",2)(2,"tui-input",3),O(3," Search for text in scenarios "),D(4,"input",4),d()(),c(5,"div",5)(6,"button",6),_("click",function(){P(p);let m=F(8);return R(m.prev())}),d(),c(7,"tui-carousel",7,0),oe("indexChange",function(m){return P(p),ne(r.index,m)||(r.index=m),R(m)}),h(9,ji,2,0,"ng-container",8),d(),c(10,"button",9),_("click",function(){P(p);let m=F(8);return R(m.next())}),d()()()}n&2&&(l(),a("formGroup",r.searchForm),l(),a("formControlName","search")("tuiTextfieldIcon","tuiIconSearchLarge")("tuiTextfieldCleaner",!0),l(5),a("draggable",!0)("itemsCount",r.carouselCount),ie("index",r.index),l(2),a("ngForOf",r.filteredItems))},dependencies:[z,Tt,ue,ve,me,le,ce,ge,fe,he,mi,pi,Ke,Me,Se,xe,we,Oe,Ie,_e,Ce,ye,Te],encapsulation:2});let e=o;return e})();function zi(e,o){e&1&&W(0)}function Hi(e,o){if(e&1&&(c(0,"div",4),h(1,zi,1,0,"ng-container",5),d()),e&2){let t=T(),i=F(3),n=F(5);l(),a("ngIf",t._routed)("ngIfThen",i)("ngIfElse",n)}}function ki(e,o){if(e&1&&D(0,"routed-items",6),e&2){let t=T();a("gameName",t.gameName)}}function Bi(e,o){if(e&1&&D(0,"chapters-items",6),e&2){let t=T();a("gameName",t.gameName)}}var Oo=(()=>{let o=class o{constructor(i,n,r,p){this.route=i,this.restApi=n,this.gameRootService=r,this.globalLoader=p,this._routed=!1}ngOnInit(){this.gameRootService.pushHeader("Search"),this.route.parent?.paramMap.pipe(K(()=>{this.loaded=!1,this.globalLoader.setGlobalLoader(!0)}),b(i=>(this.gameName=i.get("gameName")||"",this.restApi.get("searchConfig",{pathParams:{gameName:this.gameName}})))).subscribe(i=>{this._routed=i.routed,this.loaded=!0})}};o.\u0275fac=function(n){return new(n||o)(s(Ot),s(V),s(Xt),s(k))},o.\u0275cmp=I({type:o,selectors:[["app-search"]],standalone:!0,features:[A],decls:6,vars:1,consts:[["routed",""],["nonRouted",""],[1,"search_root"],["class","search_body",4,"ngIf"],[1,"search_body"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"gameName"]],template:function(n,r){n&1&&(c(0,"div",2),h(1,Hi,2,3,"div",3),d(),h(2,ki,1,1,"ng-template",null,0,re)(4,Bi,1,1,"ng-template",null,1,re)),n&2&&(l(),a("ngIf",r.loaded))},dependencies:[se,gi,_i],encapsulation:2});let e=o;return e})();export{Oo as SearchComponent};
