import{a as x}from"./chunk-FH72FGH4.js";import{a as h}from"./chunk-S77TKC5Z.js";import{a as q}from"./chunk-BPDZKKEV.js";import{a as z}from"./chunk-6FB7K7ZM.js";import{a as V,b as W}from"./chunk-5TNR2OTO.js";import"./chunk-UEBDUWVO.js";import"./chunk-WNPWYFNT.js";import{c as b,d as g}from"./chunk-QPXJIEBY.js";import{$ as T,Ae as P,Ce as D,De as H,Ea as R,Ga as u,Ka as A,L as _,La as C,Ma as N,Na as S,O as E,Oa as c,Pa as l,Qa as F,Ya as I,eb as w,gb as $,kb as B,l as k,lb as j,mb as y,va as s,vb as G,wa as p,z as M,zb as O}from"./chunk-VIQ542NQ.js";var K=()=>({"grid-template-columns":"none"}),Q=()=>({});function U(i,a){if(i&1&&F(0,"item-card",3),i&2){let r=a.$implicit;u("name",r.name)("link",r.routerLink)("imageResource",r.imgSrc)("spoiler",r.spoiler)}}function X(i,a){if(i&1&&(c(0,"div",2),N(1,U,1,4,"item-card",3,C),l()),i&2){let r=I();s(),S(r._items)}}function Y(i,a){if(i&1&&(c(0,"a",5)(1,"button",6),w(2),l()()),i&2){let r=a.$implicit;u("routerLink",r.routerLink),s(2),$(" ",r.name,"")}}function Z(i,a){if(i&1&&(c(0,"div",4),N(1,Y,3,2,"a",5,C),l()),i&2){let r=I();u("ngClass",r._items.length>20?"search-items-grid":"items-list_container")("ngStyle",r._items.length==1?y(2,K):y(3,Q)),s(),S(r._items)}}var he=(()=>{let a=class a{constructor(o,e,t,d){this.route=o,this.router=e,this.gameRootService=t,this.restApiService=d,this._items=[],this.gameName="",this._routes=!1,this.headerText="",this.hasImages=!1,this.easterEggs=!0}ngOnInit(){window.scroll(0,0);let o=[this.route.paramMap];g.mapping||o.push(this.restApiService.get("nameMapping").pipe(E(e=>{g.mapping=e}))),this.route.parent?.paramMap.pipe(M(o),_(e=>{this.easterEggs=localStorage.getItem(b.easterEggs)?localStorage.getItem(b.easterEggs)=="true":!0,this.gameName=e[0].get("gameName");let t=this.router.url.split("/").at(-1);if(this._routes=t==="routes",this._routes)return this.restApiService.get("gameRouteConfig",{pathParams:{gameName:this.gameName}});{let d=e[1].has("routeName")?"routedGameChapterConfig":"nonRoutedGameChapterConfig";return this.restApiService.get(d,{pathParams:{gameName:this.gameName,routeName:e[1].get("routeName")}}).pipe(_(n=>{let f=[],ee=n.chapters,L=n.chapterOrder;if(L)L.forEach((m,v)=>{let J=x.resolveChapterName(n,v);f.push({name:J,routerLink:`${m}`})});else for(let m=1;m<=n.total;m++){let v=x.resolveChapterName(n,m);f.push({name:v,routerLink:`${m}`})}return k({headerLabel:n.headerLabel||e[1].get("routeName")&&`${e[1].get("routeName")} route chapters`||`${g.mapping[this.gameName]&&g.mapping[this.gameName]+" "||""}chapters`,items:f})}))}})).subscribe({next:e=>{this.easterEggs&&e?.items.some(t=>t.alternativeImgs)?this._items=e?.items.map(t=>(t.alternativeImgs&&Math.random()>.75&&(t.alternativeImgs.length>1?t.imgSrc=this.selectRandom(t.alternativeImgs):t.imgSrc=t.alternativeImgs[0]),t)):this._items=e?.items,this.hasImages=!!this._items?.some(t=>!!t.imgSrc),e.headerLabel&&this.gameRootService.pushHeader(e.headerLabel)},error:()=>{this.router.navigate(["/error"])}})}selectRandom(o){let e=Math.floor(Math.random()*o.length);return o[e]}};a.\u0275fac=function(e){return new(e||a)(p(P),p(D),p(q),p(h))},a.\u0275cmp=T({type:a,selectors:[["chapter-navigation"]],standalone:!0,features:[B([h]),j],decls:4,vars:1,consts:[[1,"items-list_body"],[1,"items-list_scroll"],[1,"items-list_container",2,"--container-width","80vw"],[3,"name","link","imageResource","spoiler"],[3,"ngClass","ngStyle"],[3,"routerLink"],["appearance","custom","tuiButton","","type","button",1,"items-list_item-button"]],template:function(e,t){e&1&&(c(0,"div",0)(1,"div",1),R(2,X,3,0,"div",2)(3,Z,3,4),l()()),e&2&&(s(2),A(2,t._routes&&t.hasImages?2:3))},dependencies:[z,G,O,H,W,V],encapsulation:2});let i=a;return i})();export{he as ChapterNavigationComponent};
